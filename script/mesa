#!/bin/bash

# exit if there is argument provided
if [ $# -eq 0 ]; then
  echo "No argument is provided. Please provide a configuration file."
  exit 1
fi

SOURCE="${BASH_SOURCE[0]}"
echo $SOURCE
if [ -h "$SOURCE" ]; then
  SOURCE="$(readlink "$SOURCE")"
fi
DIR="$(dirname $SOURCE)"

# set this to the script generated by sbt-native-packager after staging 
SCRIPT=$DIR/../target/universal/stage/bin/mesa

# workaround for JOGL
export JAVA_OPTS="$JAVA_OPTS --add-opens java.desktop/sun.awt=ALL-UNNAMED"

# workaround for Java fullscreen support on mac machines
if [[ "$OSTYPE" == darwin* ]]; then
  export JAVA_OPTS="$JAVA_OPTS --add-opens java.desktop/com.apple.eawt=ALL-UNNAMED"
fi

if [ -x $SCRIPT ]; then
  $SCRIPT $@
else
  echo "Script $SCRIPT does not exist. Please run sbt stage"
fi

